--echo #
--echo # MDEV-31474 KDF() function
--echo #
select hex(kdf('foo', 'bar'));
select hex(kdf('foo', 'bar')); # same result every time
select hex(kdf('faa', 'bar'));
select hex(kdf('foo', 'bor'));

select hex(kdf('foo', 'bar', 10));
select hex(kdf('foo', 'bar', 11));

select hex(kdf('foo', 'bar', 'info', 'hkdf'));
select hex(kdf('foo', 'bar', 'infa', 'hkdf'));
select hex(kdf('foo', 'bar', 'info', 'pbkdf2_hmac'));
select hex(kdf('foo', 'bar', 1, 'pbkdf2_hmac'));
select hex(kdf('foo', 'bar', 10, 'pbkdf2_hmac'));

select hex(kdf(NULL, 'bar'));
select hex(kdf('foo', NULL));
select hex(kdf('foo', 'bar', NULL, 'hkdf'));
select hex(kdf('foo', 'bar', NULL, 'pbkdf2_hmac'));
select hex(kdf('foo', 'bar', 2000, NULL));
select hex(kdf('foo', 'bar', 2000, 'foo'));
select hex(kdf('foo', 'bar', 1000, 'pbkdf2_hmac', NULL));
select hex(kdf('foo', 'bar', 1000, 'pbkdf2_hmac', 10));
select hex(kdf('foo', 'bar', 1000, 'pbkdf2_hmac', 16));

set @@block_encryption_mode='aes-192-cbc';
select hex(kdf('foo', 'bar', 'info', 'hkdf'));
select hex(kdf('foo', 'bar', 'info', 'hkdf', 256));
select hex(kdf('foo', 'bar', 2000, 'pbkdf2_hmac'));
select hex(kdf('foo', 'bar', 2000, 'pbkdf2_hmac', 256));

set @key=kdf('password', 'salt', 2048);
select hex(aes_encrypt('secret', @key, '1234123412341234'));
select aes_decrypt(x'9EED553CDDEE426D5635EF559E015ECA', @key, '1234123412341234');

--echo #
--echo # End of 11.2 tests
--echo #

